(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1627:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var a=r(5155),s=r(2115),i=r(5417),l=r(9962);function c(e){let{product:t}=e,{addToCart:r}=(0,l._)(),[i,c]=(0,s.useState)(!1);return(0,a.jsxs)("article",{className:"bg-white rounded-lg shadow-sm overflow-hidden border border-gray-100 flex flex-col h-full",children:[(0,a.jsx)("div",{className:"h-40 bg-gray-100 w-full flex items-center justify-center",children:t.image_url&&!i?(0,a.jsx)("img",{src:t.image_url,alt:t.name,className:"object-cover h-full w-full",onError:()=>c(!0),loading:"lazy"}):(0,a.jsx)("div",{className:"text-gray-400 text-sm",children:"No Image"})}),(0,a.jsxs)("div",{className:"p-3 flex-1 flex flex-col",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900 line-clamp-2",children:t.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:t.category}),(0,a.jsxs)("div",{className:"mt-auto flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"text-blue-600 font-bold",children:["Rp ",t.price.toLocaleString("id-ID")]}),(0,a.jsx)("button",{onClick:()=>r({id:t.id,name:t.name,price:t.price,image:t.image_url}),className:"px-3 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 touch-manipulation","aria-label":"Tambah ".concat(t.name," ke keranjang"),children:"Tambah"})]})]})]})}function d(){let[e,t]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),d=(0,i.createBrowserClient)("https://zlbkspsokztxaioztigk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpsYmtzcHNva3p0eGFpb3p0aWdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MDcxODksImV4cCI6MjA4MzI4MzE4OX0.hh6RJkGO_c-QnFPbO8UmLrf8lB6-OMKDnK2_CCyLTnQ");return(0,s.useEffect)(()=>{!async function(){l(!0);let{data:e}=await d.from("products").select("id, name, image_url, category, sold_count"),{data:r}=await d.from("tiers").select("id").eq("name","Consumer").single();if(e&&r){let{data:a}=await d.from("product_prices").select("product_id, price").eq("tier_id",r.id);t(e.map(e=>{let t=null==a?void 0:a.find(t=>t.product_id===e.id);return{...e,price:(null==t?void 0:t.price)||0}}))}l(!1)}()},[d]),(0,a.jsxs)("main",{children:[(0,a.jsxs)("header",{className:"mb-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Katalog Produk"}),(0,a.jsxs)("div",{className:"mt-2 flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Filter:"}),(0,a.jsx)("button",{className:"text-sm px-2 py-1 rounded-md border border-gray-200 text-gray-700",children:"Kategori"}),(0,a.jsx)("button",{className:"text-sm px-2 py-1 rounded-md border border-gray-200 text-gray-700",children:"Harga"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"sort",className:"sr-only",children:"Sort"}),(0,a.jsxs)("select",{id:"sort",className:"text-sm rounded-md border border-gray-200 px-2 py-1",children:[(0,a.jsx)("option",{value:"popular",children:"Populer"}),(0,a.jsx)("option",{value:"price_asc",children:"Harga: Rendah → Tinggi"}),(0,a.jsx)("option",{value:"price_desc",children:"Harga: Tinggi → Rendah"})]})]})]})]}),r?(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Array.from({length:4}).map((e,t)=>(0,a.jsx)("div",{className:"h-44 bg-gray-100 rounded-md animate-pulse"},t))}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:e.map(e=>(0,a.jsx)(c,{product:e},e.id))}),!r&&0===e.length&&(0,a.jsx)("p",{className:"text-center text-gray-500 mt-6",children:"Belum ada produk."})]})}},6349:(e,t,r)=>{Promise.resolve().then(r.bind(r,1627))},9962:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>l,_:()=>c});var a=r(5155),s=r(2115);let i=(0,s.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,s.useState)([]),[c,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{try{let e=localStorage.getItem("cart");e&&l(JSON.parse(e))}catch(e){}},[]),(0,s.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(r))},[r]);let n=r.reduce((e,t)=>e+t.quantity,0),o=r.reduce((e,t)=>e+t.price*t.quantity,0);return(0,a.jsx)(i.Provider,{value:{items:r,totalCount:n,totalPrice:o,cartOpen:c,openCart:()=>d(!0),closeCart:()=>d(!1),toggleCart:()=>d(e=>!e),addToCart:e=>{l(t=>{let r=t.findIndex(t=>t.id===e.id);if(r>=0){let e=[...t];return e[r].quantity+=1,e}return d(!0),[...t,{...e,quantity:1}]})},removeFromCart:e=>{l(t=>t.filter(t=>t.id!==e))},updateQuantity:(e,t)=>{l(r=>r.map(r=>r.id===e?{...r,quantity:Math.max(1,t)}:r))},clearCart:()=>l([])},children:t})},c=()=>{let e=(0,s.useContext)(i);if(!e)throw Error("useCart must be used within CartProvider");return e}}},e=>{e.O(0,[417,441,255,358],()=>e(e.s=6349)),_N_E=e.O()}]);